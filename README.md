# Image Previewer

## Обзор

**Image Previewer** — это веб-сервис на языке Go, который изменяет размер изображений по требованию. 
Получая URL изображения и желаемые размеры, он загружает изображение, изменяет его размер до указанных параметров, 
кэширует результат и отправляет его клиенту.

## Содержание

- [Требования](#требования)
- [Установка](#установка)
- [Конфигурация](#конфигурация)
- [Использование](#использование)
   - [Запуск приложения](#запуск-приложения)
   - [API Endpoint](#api-endpoint)
- [Тестирование](#тестирование)

## Требования

- **Go**: версия 1.23 или выше.
- **Make**: для использования предоставленного `Makefile`.
- **Git**: для клонирования репозитория.

## Установка

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/romangricuk/image-previewer.git
   cd image-previewer
   ```

2. **Загрузите зависимости:**

   ```bash
   go mod download
   ```

## Конфигурация

Приложение может быть настроено с помощью переменных окружения или путем изменения пакета `config`. Ниже представлены доступные параметры конфигурации:

- **APP_PORT**: Порт, на котором работает сервер. По умолчанию `8080`.
- **CACHE_SIZE**: Максимальное количество изображений для хранения в кэше. По умолчанию `100`.
- **CACHE_DIR**: Директория, где хранятся кэшированные изображения. По умолчанию `./cache`.
- **LOG_LEVEL**: Уровень логирования (`debug`, `info`, `warn`, `error`, `fatal`). По умолчанию `info`.

Вы можете создать файл `.env` в корневом каталоге для установки этих переменных:

```env
APP_PORT=8080
CACHE_SIZE=100
CACHE_DIR=./cache
LOG_LEVEL=info
SHUTDOWN_TIMEOUT=5s
```

## Использование

### Запуск приложения

Вы можете собрать и запустить приложение, используя предоставленный `Makefile`.

**Сборка приложения:**

```bash
make build
```

Эта команда компилирует приложение и помещает исполняемый файл в директорию `bin/`.

**Запуск приложения:**

```bash
make run
```

Эта команда запускает скомпилированное приложение.

Кроме того, вы можете собрать и запустить приложение одной командой:

```bash
make run-app
```

**Очистка сборочных артефактов:**

```bash
make clean
```

### API Endpoint

**Формат Endpoint:**

```
http://localhost:<APP_PORT>/fill/<width>/<height>/<image_url>
```

- **`<width>`**: Желаемая ширина изображения.
- **`<height>`**: Желаемая высота изображения.
- **`<image_url>`**: URL оригинального изображения (без указания протокола).

**Пример:**

Чтобы изменить размер изображения до 300x200 пикселей:

```
http://localhost:8080/fill/300/200/raw.githubusercontent.com/OtusGolang/final_project/master/examples/image-previewer/gopher_1024x252.jpg
```

**Примечание:** URL изображения должен быть без указания протокола (`http://` или `https://`).

## Тестирование

Проект включает юнит-тесты и интеграционные тесты.

**Запуск всех тестов:**

```bash
make test
```

Эта команда запускает все тесты и выводит результаты.
